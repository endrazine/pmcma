/*
*
*          Post memory corruption memory analyzer
*
*
*
*   Copyright 2011 Toucan System SARL
*
*   Licensed under the Apache License, Version 2.0 (the "License");
*   you may not use this file except in compliance with the License.
*   You may obtain a copy of the License at
*
*       http://www.apache.org/licenses/LICENSE-2.0
*
*   Unless required by applicable law or agreed to in writing, software
*   distributed under the License is distributed on an "AS IS" BASIS,
*   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
*   See the License for the specific language governing permissions and
*   limitations under the License.
*
*
*/

int my_syscalls[]={
0,
1,
2,
3,
4,
5,
6,
7,
8,
9,
10,
11,
12,
13,
14,
15,
16,
17,
18,
19,
20,
21,
22,
23,
24,
25,
26,
27,
28,
29,
30,
31,
32,
33,
34,
35,
36,
37,
38,
39,
40,
41,
42,
43,
44,
45,
46,
47,
48,
49,
50,
51,
52,
53,
54,
55,
56,
57,
58,
59,
60,
61,
62,
63,
64,
65,
66,
67,
68,
69,
70,
71,
72,
73,
74,
75,
76,
77,
78,
79,
80,
81,
82,
83,
84,
85,
86,
87,
88,
89,
90,
91,
92,
93,
94,
95,
96,
97,
98,
99,
100,
101,
102,
103,
104,
105,
106,
107,
108,
109,
110,
111,
112,
113,
114,
115,
116,
117,
118,
119,
120,
121,
122,
123,
124,
125,
126,
127,
128,
129,
130,
131,
132,
133,
134,
135,
136,
137,
138,
139,
140,
141,
142,
143,
144,
145,
146,
147,
148,
149,
150,
151,
152,
153,
154,
155,
156,
157,
158,
159,
160,
161,
162,
163,
164,
165,
166,
167,
168,
169,
170,
171,
172,
173,
174,
175,
176,
177,
178,
179,
180,
181,
182,
183,
184,
185,
186,
187,
188,
189,
190,
191,
192,
193,
194,
195,
196,
197,
198,
199,
200,
201,
202,
203,
204,
205,
206,
207,
208,
209,
210,
211,
212,
213,
214,
215,
216,
217,
218,
219,
219,
220,
221,
224,
225,
226,
227,
228,
229,
230,
231,
232,
233,
234,
235,
236,
237,
238,
239,
240,
241,
242,
243,
244,
245,
246,
247,
248,
249,
250,
252,
253,
254,
255,
256,
257,
258,
259,
260,
261,
262,
263,
264,
265,
266,
267,
268,
269,
270,
271,
272,
273,
274,
275,
276,
277,
278,
279,
280,
281,
282,
283,
284,
286,
287,
288,
289,
290,
291,
292,
293,
294,
295,
296,
297,
298,
299,
300,
301,
302,
303,
304,
305,
306,
307,
308,
309,
310,
311,
312,
313,
314,
315,
316,
317,
318,
319,
320,
321,
322,
323,
324,
325,
326,
327,
328,
329,
330,
331,
332,
333,
334,
335,
336,
337
};


char *syscall_names[]={
"restart_syscall",
"exit",
"fork",
"read",
"write",
"open",
"close",
"waitpid",
"creat",
"link",
"unlink",
"execve",
"chdir",
"time",
"mknod",
"chmod",
"lchown",
"break",
"oldstat",
"lseek",
"getpid",
"mount",
"umount",
"setuid",
"getuid",
"stime",
"ptrace",
"alarm",
"oldfstat",
"pause",
"utime",
"stty",
"gtty",
"access",
"nice",
"ftime",
"sync",
"kill",
"rename",
"mkdir",
"rmdir",
"dup",
"pipe",
"times",
"prof",
"brk",
"setgid",
"getgid",
"signal",
"geteuid",
"getegid",
"acct",
"umount2",
"lock",
"ioctl",
"fcntl",
"mpx",
"setpgid",
"ulimit",
"oldolduname",
"umask",
"chroot",
"ustat",
"dup2",
"getppid",
"getpgrp",
"setsid",
"sigaction",
"sgetmask",
"ssetmask",
"setreuid",
"setregid",
"sigsuspend",
"sigpending",
"sethostname",
"setrlimit",
"getrlimit",
"getrusage",
"gettimeofday",
"settimeofday",
"getgroups",
"setgroups",
"select",
"symlink",
"oldlstat",
"readlink",
"uselib",
"swapon",
"reboot",
"readdir",
"mmap",
"munmap",
"truncate",
"ftruncate",
"fchmod",
"fchown",
"getpriority",
"setpriority",
"profil",
"statfs",
"fstatfs",
"ioperm",
"socketcall",
"syslog",
"setitimer",
"getitimer",
"stat",
"lstat",
"fstat",
"olduname",
"iopl",
"vhangup",
"idle",
"vm86old",
"wait4",
"swapoff",
"sysinfo",
"ipc",
"fsync",
"sigreturn",
"clone",
"setdomainname",
"uname",
"modify_ldt",
"adjtimex",
"mprotect",
"sigprocmask",
"create_module",
"init_module",
"delete_module",
"get_kernel_syms",
"quotactl",
"getpgid",
"fchdir",
"bdflush",
"sysfs",
"personality",
"afs_syscall",
"setfsuid",
"setfsgid",
"_llseek",
"getdents",
"_newselect",
"flock",
"msync",
"readv",
"writev",
"getsid",
"fdatasync",
"_sysctl",
"mlock",
"munlock",
"mlockall",
"munlockall",
"sched_setparam",
"sched_getparam",
"sched_setscheduler",
"sched_getscheduler",
"sched_yield",
"sched_get_priority_max",
"sched_get_priority_min",
"sched_rr_get_interval",
"nanosleep",
"mremap",
"setresuid",
"getresuid",
"vm86",
"query_module",
"poll",
"nfsservctl",
"setresgid",
"getresgid",
"prctl",
"rt_sigreturn",
"rt_sigaction",
"rt_sigprocmask",
"rt_sigpending",
"rt_sigtimedwait",
"rt_sigqueueinfo",
"rt_sigsuspend",
"pread64",
"pwrite64",
"chown",
"getcwd",
"capget",
"capset",
"sigaltstack",
"sendfile",
"getpmsg",
"putpmsg",
"vfork",
"ugetrlimit",
"mmap2",
"truncate64",
"ftruncate64",
"stat64",
"lstat64",
"fstat64",
"lchown32",
"getuid32",
"getgid32",
"geteuid32",
"getegid32",
"setreuid32",
"setregid32",
"getgroups32",
"setgroups32",
"fchown32",
"setresuid32",
"getresuid32",
"setresgid32",
"getresgid32",
"chown32",
"setuid32",
"setgid32",
"setfsuid32",
"setfsgid32",
"pivot_root",
"mincore",
"madvise",
"madvise1",
"getdents64",
"fcntl64",
"gettid",
"readahead",
"setxattr",
"lsetxattr",
"fsetxattr",
"getxattr",
"lgetxattr",
"fgetxattr",
"listxattr",
"llistxattr",
"flistxattr",
"removexattr",
"lremovexattr",
"fremovexattr",
"tkill",
"sendfile64",
"futex",
"sched_setaffinity",
"sched_getaffinity",
"set_thread_area",
"get_thread_area",
"io_setup",
"io_destroy",
"io_getevents",
"io_submit",
"io_cancel",
"fadvise64",
"exit_group",
"lookup_dcookie",
"epoll_create",
"epoll_ctl",
"epoll_wait",
"remap_file_pages",
"set_tid_address",
"timer_create",
"timer_settime",
"timer_gettime",
"timer_getoverrun",
"timer_delete",
"clock_settime",
"clock_gettime",
"clock_getres",
"clock_nanosleep",
"statfs64",
"fstatfs64",
"tgkill",
"utimes",
"fadvise64_64",
"vserver",
"mbind",
"get_mempolicy",
"set_mempolicy",
"mq_open",
"mq_unlink",
"mq_timedsend",
"mq_timedreceive",
"mq_notify",
"mq_getsetattr",
"kexec_load",
"waitid",
"add_key",
"request_key",
"keyctl",
"ioprio_set",
"ioprio_get",
"inotify_init",
"inotify_add_watch",
"inotify_rm_watch",
"migrate_pages",
"openat",
"mkdirat",
"mknodat",
"fchownat",
"futimesat",
"fstatat64",
"unlinkat",
"renameat",
"linkat",
"symlinkat",
"readlinkat",
"fchmodat",
"faccessat",
"pselect6",
"ppoll",
"unshare",
"set_robust_list",
"get_robust_list",
"splice",
"sync_file_range",
"tee",
"vmsplice",
"move_pages",
"getcpu",
"epoll_pwait",
"utimensat",
"signalfd",
"timerfd_create",
"eventfd",
"fallocate",
"timerfd_settime",
"timerfd_gettime",
"signalfd4",
"eventfd2",
"epoll_create1",
"dup3",
"pipe2",
"inotify_init1",
"preadv",
"pwritev",
"rt_tgsigqueueinfo",
"perf_event_open",
"recvmmsg"
};


int whitelist[]={
4,   //#define __NR_write		  4
146, //#define __NR_writev		146
181, //#define __NR_pwrite64		181
187, //#define __NR_sendfile		187
189, //#define __NR_putpmsg		189
239, //#define __NR_sendfile64		239
334, //#define __NR_pwritev		334
};


